{"version":3,"file":"searchable-select.js","sources":["../../../../../../src/zoo-modules/form/searchable-select/searchable-select.js"],"sourcesContent":["import { registerComponents } from '../../common/register-components.js';\nimport { CrossIcon } from '../../icon/cross-icon/cross-icon.js';\nimport { FormElement } from '../common/FormElement.js';\nimport { Input } from '../input/input.js';\nimport { Select } from '../select/select.js';\nimport { Preloader } from '../../misc/preloader/preloader.js';\nimport { Tooltip } from '../../misc/tooltip/tooltip.js';\n\n/**\n * @injectHTML\n */\nexport class SearchableSelect extends FormElement {\n\tconstructor() {\n\t\tsuper();\n\t\tregisterComponents(Input, Select, Preloader, CrossIcon, Tooltip);\n\t\tthis.observer = new MutationObserver(mutationsList => {\n\t\t\tfor (let mutation of mutationsList) {\n\t\t\t\tthis.input.disabled = mutation.target.disabled;\n\t\t\t\tconst crossIcon = this.shadowRoot.querySelector('.cross');\n\t\t\t\tif (mutation.target.disabled) {\n\t\t\t\t\tcrossIcon.classList.add('hidden');\n\t\t\t\t} else {\n\t\t\t\t\tcrossIcon.classList.remove('hidden');\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis.shadowRoot.querySelector('.cross').addEventListener('click', () => {\n\t\t\tif (this.select.disabled) return;\n\t\t\tthis.select.value = null;\n\t\t\tthis.select.dispatchEvent(new Event('change', { bubbles: true, cancelable: false }));\n\t\t});\n\t\t\n\t\tthis.shadowRoot.querySelector('slot[name=\"select\"]').addEventListener('slotchange', e => {\n\t\t\tthis.select = [...e.target.assignedElements()].find(el => el.tagName === 'SELECT');\n\t\t\tif (!this.select) return;\n\t\t\tthis.registerElementForValidation(this.select);\n\t\t\tthis.select.addEventListener('change', () => {\n\t\t\t\tthis.handleOptionChange();\n\t\t\t\tthis.valueChange();\n\t\t\t});\n\t\t\tthis.select.size = 4;\n\t\t\tthis.observer.observe(this.select, { attributes: true, attributeFilter: ['disabled'] });\n\t\t\tthis.valueChange();\n\t\t\tthis.slotChange();\n\t\t});\n\n\t\tthis.shadowRoot.querySelector('slot[name=\"input\"]').addEventListener('slotchange', e => {\n\t\t\tthis.input = [...e.target.assignedElements()].find(el => el.tagName === 'INPUT');\n\t\t\tif (!this.input) return;\n\t\t\tthis.inputPlaceholderFallback = this.input.placeholder;\n\t\t\tthis.input.addEventListener('input', () => this.handleSearchChange());\n\t\t\tthis.slotChange();\n\t\t});\n\t}\n\t\n\tstatic get observedAttributes() {\n\t\treturn ['closeicontitle'];\n\t}\n\n\tslotChange() {\n\t\tif (this.input && this.select) {\n\t\t\tthis.handleOptionChange();\n\t\t\tthis.input.disabled = this.select.disabled;\n\t\t}\n\t}\n\n\tvalueChange() {\n\t\tthis.select.value ? this.setAttribute('value-selected', '') : this.removeAttribute('value-selected');\n\t}\n\n\tattributeChangedCallback(attrName, oldVal, newVal) {\n\t\tthis.shadowRoot.querySelector('zoo-cross-icon').setAttribute('title', newVal);\n\t}\n\n\thandleSearchChange() {\n\t\tconst inputVal = this.input.value.toLowerCase();\n\t\tthis.select.querySelectorAll('option').forEach(option => {\n\t\t\tif (option.text.toLowerCase().indexOf(inputVal) > -1) option.style.display = 'block';\n\t\t\telse option.style.display = 'none';\n\t\t});\n\t}\n\n\thandleOptionChange() {\n\t\tlet inputValString = [...this.select.selectedOptions].map(o => o.text).join(', \\n');\n\t\tthis.input.placeholder = inputValString || this.inputPlaceholderFallback;\n\t\tif (inputValString) {\n\t\t\tthis.input.value = null;\n\t\t\tthis.tooltip = this.tooltip || this.createTooltip();\n\t\t\tthis.tooltip.textContent = inputValString;\n\t\t\tthis.shadowRoot.querySelector('zoo-input').appendChild(this.tooltip);\n\t\t} else if (this.tooltip) {\n\t\t\tthis.tooltip.remove();\n\t\t}\n\t}\n\n\tcreateTooltip() {\n\t\tconst tooltip = document.createElement('zoo-tooltip');\n\t\ttooltip.slot = 'additional';\n\t\ttooltip.setAttribute('position', 'right');\n\t\treturn tooltip;\n\t}\n\n\tdisconnectedCallback() {\n\t\tthis.observer.disconnect();\n\t}\n}\nif (!window.customElements.get('zoo-searchable-select')) {\n\twindow.customElements.define('zoo-searchable-select', SearchableSelect);\n}"],"names":[],"mappings":";;;;;;;;AAQA;AACA;AACA;AACO,MAAM,gBAAgB,SAAS,WAAW,CAAC;AAClD,CAAC,WAAW,GAAG;AACf,EAAE,KAAK,EAAE,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,4xEAA4xE,CAAC,CAAC;AACp1E,EAAE,kBAAkB,CAAC,KAAK,EAAE,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,CAAC,CAAC;AACnE,EAAE,IAAI,CAAC,QAAQ,GAAG,IAAI,gBAAgB,CAAC,aAAa,IAAI;AACxD,GAAG,KAAK,IAAI,QAAQ,IAAI,aAAa,EAAE;AACvC,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC;AACnD,IAAI,MAAM,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;AAC9D,IAAI,IAAI,QAAQ,CAAC,MAAM,CAAC,QAAQ,EAAE;AAClC,KAAK,SAAS,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;AACvC,KAAK,MAAM;AACX,KAAK,SAAS,CAAC,SAAS,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;AAC1C,KAAK;AACL,IAAI;AACJ,GAAG,CAAC,CAAC;AACL,EAAE,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM;AAC1E,GAAG,IAAI,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,OAAO;AACpC,GAAG,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;AAC5B,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,IAAI,KAAK,CAAC,QAAQ,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;AACxF,GAAG,CAAC,CAAC;AACL;AACA,EAAE,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,qBAAqB,CAAC,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,IAAI;AAC3F,GAAG,IAAI,CAAC,MAAM,GAAG,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,OAAO,KAAK,QAAQ,CAAC,CAAC;AACtF,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE,OAAO;AAC5B,GAAG,IAAI,CAAC,4BAA4B,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AAClD,GAAG,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,QAAQ,EAAE,MAAM;AAChD,IAAI,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC9B,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;AACvB,IAAI,CAAC,CAAC;AACN,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,GAAG,CAAC,CAAC;AACxB,GAAG,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,EAAE,UAAU,EAAE,IAAI,EAAE,eAAe,EAAE,CAAC,UAAU,CAAC,EAAE,CAAC,CAAC;AAC3F,GAAG,IAAI,CAAC,WAAW,EAAE,CAAC;AACtB,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;AACrB,GAAG,CAAC,CAAC;AACL;AACA,EAAE,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC,gBAAgB,CAAC,YAAY,EAAE,CAAC,IAAI;AAC1F,GAAG,IAAI,CAAC,KAAK,GAAG,CAAC,GAAG,CAAC,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC,IAAI,CAAC,EAAE,IAAI,EAAE,CAAC,OAAO,KAAK,OAAO,CAAC,CAAC;AACpF,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,OAAO;AAC3B,GAAG,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC;AAC1D,GAAG,IAAI,CAAC,KAAK,CAAC,gBAAgB,CAAC,OAAO,EAAE,MAAM,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;AACzE,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;AACrB,GAAG,CAAC,CAAC;AACL,EAAE;AACF;AACA,CAAC,WAAW,kBAAkB,GAAG;AACjC,EAAE,OAAO,CAAC,gBAAgB,CAAC,CAAC;AAC5B,EAAE;AACF;AACA,CAAC,UAAU,GAAG;AACd,EAAE,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,MAAM,EAAE;AACjC,GAAG,IAAI,CAAC,kBAAkB,EAAE,CAAC;AAC7B,GAAG,IAAI,CAAC,KAAK,CAAC,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC;AAC9C,GAAG;AACH,EAAE;AACF;AACA,CAAC,WAAW,GAAG;AACf,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,EAAE,CAAC,GAAG,IAAI,CAAC,eAAe,CAAC,gBAAgB,CAAC,CAAC;AACvG,EAAE;AACF;AACA,CAAC,wBAAwB,CAAC,QAAQ,EAAE,MAAM,EAAE,MAAM,EAAE;AACpD,EAAE,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC,YAAY,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AAChF,EAAE;AACF;AACA,CAAC,kBAAkB,GAAG;AACtB,EAAE,MAAM,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC;AAClD,EAAE,IAAI,CAAC,MAAM,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,MAAM,IAAI;AAC3D,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,EAAE,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,OAAO,CAAC;AACxF,QAAQ,MAAM,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC;AACtC,GAAG,CAAC,CAAC;AACL,EAAE;AACF;AACA,CAAC,kBAAkB,GAAG;AACtB,EAAE,IAAI,cAAc,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;AACtF,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,GAAG,cAAc,IAAI,IAAI,CAAC,wBAAwB,CAAC;AAC3E,EAAE,IAAI,cAAc,EAAE;AACtB,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC;AAC3B,GAAG,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC;AACvD,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,cAAc,CAAC;AAC7C,GAAG,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,WAAW,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;AACxE,GAAG,MAAM,IAAI,IAAI,CAAC,OAAO,EAAE;AAC3B,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC;AACzB,GAAG;AACH,EAAE;AACF;AACA,CAAC,aAAa,GAAG;AACjB,EAAE,MAAM,OAAO,GAAG,QAAQ,CAAC,aAAa,CAAC,aAAa,CAAC,CAAC;AACxD,EAAE,OAAO,CAAC,IAAI,GAAG,YAAY,CAAC;AAC9B,EAAE,OAAO,CAAC,YAAY,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;AAC5C,EAAE,OAAO,OAAO,CAAC;AACjB,EAAE;AACF;AACA,CAAC,oBAAoB,GAAG;AACxB,EAAE,IAAI,CAAC,QAAQ,CAAC,UAAU,EAAE,CAAC;AAC7B,EAAE;AACF,CAAC;AACD,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,GAAG,CAAC,uBAAuB,CAAC,EAAE;AACzD,CAAC,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,uBAAuB,EAAE,gBAAgB,CAAC,CAAC;AACzE;;;;"}