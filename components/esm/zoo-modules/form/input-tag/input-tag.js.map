{"version":3,"file":"input-tag.js","sources":["../../../../../../src/zoo-modules/form/input-tag/input-tag.js"],"sourcesContent":["import { registerComponents } from '../../common/register-components.js';\nimport { Input } from '../input/input.js';\nimport { Select } from '../select/select.js';\nimport { InputTagOption } from './input-tag-option.js';\nimport { FormElement } from '../common/FormElement.js';\nimport { CrossIcon } from '../../icon/cross-icon/cross-icon.js';\n\n/**\n * @injectHTML\n */\nexport class InputTag extends FormElement {\n\tconstructor() {\n\t\tsuper();\n\t\tregisterComponents(Input, Select, InputTagOption, CrossIcon);\n\t\tthis.inputSlot = this.shadowRoot.querySelector('slot[name=\"input\"]');\n\t\tthis.inputSlot.addEventListener('slotchange', e => {\n\t\t\tconst input = [...e.target.assignedElements()].find(el => el.tagName === 'INPUT');\n\t\t\tif (input) {\n\t\t\t\tthis.input = input;\n\t\t\t\tthis.input.addEventListener('input', e => {\n\t\t\t\t\tif (e.target.value) {\n\t\t\t\t\t\tthis.setAttribute('show-tags', '');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.removeAttribute('show-tags');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tthis.addEventListener('keydown', e => {\n\t\t\tif (e.key === ' ' && e.target.tagName === 'ZOO-TAG') {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis.handleTagSelect(e);\n\t\t\t}\n\t\t});\n\t\tthis.shadowRoot.querySelector('slot[name=\"select\"]').addEventListener('slotchange', e => {\n\t\t\tthis.select = [...e.target.assignedElements()].find(el => el.tagName === 'SELECT');\n\t\t\tthis.select && this.registerElementForValidation(this.select);\n\t\t});\n\t\tthis.shadowRoot.querySelector('slot[name=\"tag-option\"]').addEventListener('click', e => {\n\t\t\tthis.handleTagSelect(e);\n\t\t});\n\t}\n\n\thandleTagSelect(e) {\n\t\tconst target = this.getElAsParentBySlotName(e.target, 'tag-option');\n\t\tconst tag = target.querySelector('zoo-tag');\n\t\tconst selectedValue = tag.getAttribute('data-value');\n\t\tconst options = [...this.select.querySelectorAll('option')];\n\t\tconst matchedOptionIndex = options.findIndex(o => o.value === selectedValue);\n\t\tif (matchedOptionIndex > -1 && !this.select.options[matchedOptionIndex].selected) {\n\t\t\tthis.select.options[matchedOptionIndex].selected = true;\n\t\t\tthis.select.options[matchedOptionIndex].setAttribute('selected', '');\n\t\t\tthis.select.dispatchEvent(new Event('input'));\n\t\t\tthis.input.value = '';\n\t\t\tconst clonedTag = tag.cloneNode(true);\n\t\t\tconst crossIcon = document.createElement('zoo-cross-icon');\n\t\t\tcrossIcon.setAttribute('tabindex', 0);\n\t\t\tcrossIcon.setAttribute('slot', 'post');\n\t\t\tcrossIcon.addEventListener('click', () => this.deselectOption(clonedTag, matchedOptionIndex));\n\t\t\tcrossIcon.addEventListener('keydown', e => {\n\t\t\t\tif (e.key === ' ') {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tthis.deselectOption(clonedTag, matchedOptionIndex);\n\t\t\t\t}\n\t\t\t});\n\t\t\tclonedTag.appendChild(crossIcon);\n\t\t\tthis.inputSlot.before(clonedTag);\n\t\t}\n\t\tthis.removeAttribute('show-tags');\n\t\tthis.input.focus();\n\t}\n\n\tdeselectOption(clonedTag, matchedOptionIndex) {\n\t\tclonedTag.remove();\n\t\tthis.select.options[matchedOptionIndex].selected = false;\n\t\tthis.select.options[matchedOptionIndex].removeAttribute('selected');\n\t\tthis.select.dispatchEvent(new Event('input'));\n\t\tthis.input.focus();\n\t}\n\n\tgetElAsParentBySlotName(startEl, slotName) {\n\t\tif (startEl.getAttribute('slot') === slotName) return startEl;\n\t\tlet el = startEl.parentElement;\n\t\twhile (el && el.getAttribute('slot') !== slotName) {\n\t\t\tel = el.parentElement;\n\t\t}\n\t\treturn el;\n\t}\n}\nif (!window.customElements.get('zoo-input-tag')) {\n\twindow.customElements.define('zoo-input-tag', InputTag);\n}"],"names":[],"mappings":"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"}