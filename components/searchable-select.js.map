{"version":3,"file":"searchable-select.js","sources":["../../src/zoo-modules/form-modules/common/FormElement.js","../../src/zoo-modules/form-modules/searchable-select-module/searchable-select.js"],"sourcesContent":["export default class FormElement extends HTMLElement {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tregisterElementForValidation(element) {\n\t\telement.addEventListener('invalid', () => {\n\t\t\tthis.setAttribute('invalid', '');\n\t\t\tthis.setAttribute('aria-invalid', '');\n\t\t});\n\t\telement.addEventListener('change', () => {\n\t\t\tif (element.checkValidity()) {\n\t\t\t\tthis.removeAttribute('invalid');\n\t\t\t} else {\n\t\t\t\tthis.setAttribute('invalid', '');\n\t\t\t\tthis.setAttribute('aria-invalid', '');\n\t\t\t}\n\t\t});\n\t}\n}","import FormElement from '../common/FormElement.js';\n\n/**\n * @injectHTML\n */\nexport class SearchableSelect extends FormElement {\n\tconstructor() {\n\t\tsuper();\n\t}\n\t// TODO in v9 drop nested default input and force user to define label for both select and input, while showing only legend\n\tstatic get observedAttributes() {\n\t\treturn ['invalid', 'placeholder'];\n\t}\n\thandlePlaceholder(newVal) {\n\t\tconst input = this.shadowRoot.querySelector('input');\n\t\tif (input && newVal) input.placeholder = newVal;\n\t\tthis.inputPlaceholderFallback = newVal;\n\t}\n\n\t// TODO think of a way to reuse some logic from nested zoo-select, eg. valueselected, option change etc\n\tmutationCallback(mutationsList) {\n\t\tfor (let mutation of mutationsList) {\n\t\t\tif (mutation.type === 'attributes' && mutation.attributeName == 'disabled') {\n\t\t\t\tthis.input.disabled = mutation.target.disabled;\n\t\t\t}\n\t\t}\n\t}\n\n\tconnectedCallback() {\n\t\tthis.input = this.shadowRoot.querySelector('input');\n\t\tthis.input.addEventListener('input', () => this.handleSearchChange());\n\t\tthis.shadowRoot.querySelector('zoo-cross-icon').addEventListener('click', () => this.handleCrossClick());\n\t\tthis.observer = new MutationObserver(this.mutationCallback.bind(this));\n\t\tconst selectSlot = this.shadowRoot.querySelector('slot[name=\"select\"]');\n\t\tselectSlot.addEventListener('slotchange', () => {\n\t\t\tthis.select = selectSlot.assignedElements()[0];\n\t\t\tthis.registerElementForValidation(this.select);\n\t\t\tthis.select.addEventListener('change', e => {\n\t\t\t\tthis.handleOptionChange();\n\t\t\t\te.target.value ? this.setAttribute('valueselected', '') : this.removeAttribute('valueselected');\n\t\t\t});\n\t\t\tif (this.select.disabled && this.input) {\n\t\t\t\tthis.input.disabled = true;\n\t\t\t}\n\t\t\tthis.select.size = 4;\n\t\t\tthis.select.value ? this.setAttribute('valueselected', '') : this.removeAttribute('valueselected');\n\t\t\tthis.observer.disconnect();\n\t\t\tthis.observer.observe(this.select, { attributes: true, childList: false, subtree: false });\n\t\t\tthis.slotChange();\n\t\t});\n\n\t\tconst inputSlot = this.shadowRoot.querySelector('slot[name=\"input\"]');\n\t\tinputSlot.addEventListener('slotchange', () => {\n\t\t\tthis.input = inputSlot.assignedElements()[0];\n\t\t\tthis.inputPlaceholderFallback = this.input.placeholder;\n\t\t\tthis.input.addEventListener('input', () => this.handleSearchChange());\n\t\t\tthis.slotChange();\n\t\t});\n\t}\n\n\tslotChange() {\n\t\tif (this.input && this.select) this.handleOptionChange();\n\t}\n\n\tattributeChangedCallback(attrName, oldVal, newVal) {\n\t\tif (SearchableSelect.observedAttributes.includes(attrName)) {\n\t\t\tif (attrName == 'placeholder') {\n\t\t\t\tthis.handlePlaceholder(newVal);\n\t\t\t} else if (attrName === 'invalid') {\n\t\t\t\tif (this.hasAttribute('invalid')) {\n\t\t\t\t\tthis.shadowRoot.querySelector('zoo-input').setAttribute('invalid', '');\n\t\t\t\t} else {\n\t\t\t\t\tthis.shadowRoot.querySelector('zoo-input').removeAttribute('invalid');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\thandleSearchChange() {\n\t\tconst inputVal = this.input.value.toLowerCase();\n\t\tconst options = this.select.querySelectorAll('option');\n\t\tfor (const option of options) {\n\t\t\tif (option.text.toLowerCase().indexOf(inputVal) > -1) option.style.display = 'block';\n\t\t\telse option.style.display = 'none';\n\t\t}\n\t}\n\n\thandleOptionChange() {\n\t\tlet inputValString = '';\n\t\tfor (const selectedOpts of this.select.selectedOptions) {\n\t\t\tinputValString += selectedOpts.text + ', \\n';\n\t\t}\n\t\tinputValString = inputValString.substr(0, inputValString.length - 3);\n\t\tconst showTooltip = inputValString && inputValString.length > 0;\n\t\tthis.input.placeholder = showTooltip ? inputValString : this.inputPlaceholderFallback;\n\t\tif (showTooltip) {\n\t\t\tthis.input.value = null;\n\t\t\tthis.tooltip = this.tooltip || document.createElement('zoo-tooltip');\n\t\t\tthis.tooltip.slot = 'input';\n\t\t\tthis.tooltip.setAttribute('position', 'right');\n\t\t\tthis.tooltip.setAttribute('text', inputValString);\n\t\t\tthis.shadowRoot.querySelector('zoo-input').appendChild(this.tooltip);\n\t\t} else if (this.tooltip) {\n\t\t\tthis.tooltip.remove();\n\t\t}\n\t}\n\n\thandleCrossClick() {\n\t\tthis.select.value = null;\n\t\tthis.select.dispatchEvent(new Event('change', { bubbles: true, cancelable: false }));\n\t}\n}\nwindow.customElements.define('zoo-searchable-select', SearchableSelect);"],"names":[],"mappings":"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"}